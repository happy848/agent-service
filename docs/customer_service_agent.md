# 客服机器人工作流流程设计
代购平台帮助海外用户购买中国商品，寄送给他们，基本工作流是：
1. 用户了解平台： 注册、登录
2. 制作订单：用户注册后，使用平台选择商品，加入购物车
3. 完成支付：选择支付方式，转账到我们的账户，我们收到钱后充值到他的网站账户余额
4. 订单生成：用户使用余额支付，订单生成，我们进行采购
5. 订单状态查询：订单状态查询
6. 包裹状态查询：包裹状态查询，包裹运费咨询
7. 退款，退货：退款，退货

客服机器人主要用于解答用户问题，引导用户完成订单、包裹查询、充值余额完成支付等操作

下面的步骤是客服机器人工作流流程设计，包括：
1. 用户背景信息查询
2. 问题分类
3. 推理回答
4. 回答自我检查
5. 拟人回复

- 1和2可以并行执行
- 3，4，5串行执行

## 一、用户背景信息查询

### 1.1 信息获取触发
- 当客服机器人接收到用户的咨询请求时，自动启动用户背景信息查询流程
- 通过tools工具查询用户信息、订单信息、包裹信息等，查询并发执行
- 将接口传递的历史对话信息存入state中，作为用户背景信息的一部分
<!-- - 根据用户问题查询知识库，有匹配信息加入state中，作为问题背景信息的一部分，没有匹配信息，则不加入state中 -->

## 二、问题分类

1. 问题分类
- 使用关键词检测进行分类，如果关键词检测通过，则直接返回分类结果，如果关键词检测不通过，则进行下一步
- 将用户问题和背景信息传入小模型，对问题进行分类
- 具体问题可分为：
    - 新用户onboarding： 怎么注册、使用平台，怎么制作购物车、怎么完成支付
    - 支付问题：支付渠道、手续费
    - 订单问题：多久到仓库、多久到家，质检照片哪里看，怎么退货
    - 包裹问题：包裹运费构成、包裹多久到家、包裹被没收怎么办、包裹现在状态查询
    - 其他问题：用户咨询其他问题，如平台介绍、平台政策、平台活动等


## 三、推理回答

- 输入前面的背景信息和推测答案，进行深度推理，生成回答
- 回答存入state中，作为回答的一部分


## 四、回答自我检查

- 对上一步的回答进行检查，是否能回答用户的问题，是否有幻觉，是否违背常识等检查，检查不通过，则返回上一步，重新推理


## 五、拟人回复

### 5.1 语言风格调整

- 将自我检查通过的回答内容中的生硬、机械的表述转换为自然、口语化的语言
- 避免使用过于专业的术语或复杂的句式结构，使回复更符合日常交流习惯
- 根据问题的性质和场景，适当融入积极的情感元素
- 如在解决用户问题后表达"很高兴能为您解决这个问题"
- 在用户遇到困扰时表达"非常理解您的心情"
- 在合适的位置添加适当的语气词（如"呢""啦""哦"）或表情符号（如😊、👍、抱歉的表情等）
- 使回复更具亲和力和感染力，拉近与用户的距离
- 但需注意使用适度，避免过度使用影响专业性
- 采用第一人称（我、我们）和第二人称（您）进行交流，增强互动感
- 如"您可以按照我们提供的步骤进行操作，我们会一直为您提供帮助的。"
- 根据用户的背景信息和对话历史，对回复进行个性化调整
- 例如，对经常咨询的老用户，可在回复中提及之前的交流内容
- 如"记得您上次也咨询过类似的问题，这次我们为您优化了处理方案..."，提升用户的专属感
- 在回复的结尾添加友好的互动语句，引导用户进一步反馈
- 如"如果您还有其他疑问，欢迎随时向我咨询哦～"
- "希望以上信息对您有帮助，您可以尝试一下，有问题再告诉我呀。"


